---
title: 网页端收消息，究竟是推还是拉？(读后感)
date: 2018-05-13 17:23:49
tags: 写作 
categories: Architecture
---

周末看到公众号推送的一篇文章，[网页端收消息，究竟是推还是拉？](https://mp.weixin.qq.com/s/Z_xItxDUmUJO-W3bgYwb5Q)。中间有知道的，也有不知道细节的，所以整理记录下。

任何脱离业务的架构设计都是耍流氓。网页端收消息，究竟是推还是拉？对这句话深感赞同，经常看到有人喷有些面试官不给业务场景，直接问解决方案的。如果一个解决方案能适用并解决所有业务的问题，那还要架构师何用？搞个万金油的架构不就好了？题外话了，所以有童鞋面试的时候如果遇到这种情况，先问清楚业务场景，在回答问题。

## 方案一、轮询拉取

客户端每隔一段时间发起请求拉取信息。
优势：实现简单，直观且容易理解
缺点：1. 实时性差：最坏的情况下，1条消息进入队列后，10s之后才会收到
     2. 效率低下：发消息是一个低频动作，如果10次轮询才收到1条消息，请求有效性只有10%，浪费了大量服务器资源

## 案二、建立长连接

如果要兼顾实时性和效率，长连接是最佳之选，PC端聊天软件基本都是使用长连接。
题注说这种方案均有一定的局限性。暂无细谈

## 方案三、HTTP长轮询

长轮询，是通过拼装HTTP短连接来达到长连接的效果，即保证了消息100%实时，又最大化的系统效率。
HTTP长轮询的核心在于，浏览器与服务端之间建立了一条“通知连接”，它的特点是：
这是一条browser发往web-server的HTTP连接
这条连接只用来收取推送通知
不像普通的“请求-响应”式HTTP请求，这个HTTP会被服务端夯住，直到有推送通知到达，或者超过约定的时间

长连接、短连接

https://www.cnblogs.com/gotodsp/p/6366163.html
https://www.zhihu.com/question/19876749
http://web.jobbole.com/85541/